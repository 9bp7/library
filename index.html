<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="styles.css">
        <title>My Library</title>
    </head>
    <body>
      <header>
        <h1>Your Books</h1>
      </header>

      <main>
        <ul class="bookshelf">
          <!--<li class="book new-book">
            <h3>Add new book</h3>
            <form id="new-book-form">
                <label for="title">Book Title: </label>
                <input type="text" id="title">
                <label for="author">Author: </label>
                <input type="text" id="author">
                <label for="pages">Pages: </label>
                <input type="text" id="pages">
                <label for="readornot">Read yet? </label>
                <input type="checkbox" id="readornot">
                <button type="submit">Add Book</button>
            </form>
          </li>-->
        </ul>
        
        <div class="add-book">
          <button id="btn-addBook">Add Book</button>
        </div>
        
      </main>
     
    </body>

    <script>
      let myLibrary = [];
      const bookShelf = document.querySelector('.bookshelf');
      const newBookBtn = document.querySelector('#btn-addBook');

      function Book(title, author, pages, read) {
        this.title = title;
        this.author = author;
        this.pages = pages;
        this.read = read;
      }

      function addBookToLibrary(book) {
        myLibrary.push(book);
      }

      function render() {     
        bookShelf.innerHTML = "";
           
        for(let i = 0; i < myLibrary.length; i++) {
          let book = document.createElement('li');
          book.classList.add('book');
          book.innerHTML = 
            `<h3>${myLibrary[i].title}</h3>
             <p>by ${myLibrary[i].author}</p>
             <p>${myLibrary[i].pages} pages</p>`
          if(myLibrary[i].read) {
            book.innerHTML += `<p>Finished</p>`;
          } else {
            book.innerHTML += `<p>Not read yet</p>`;
          }
             
          bookShelf.appendChild(book);
        }
      }

      function toggleNewBookCard() {
        if(bookShelf.querySelector('.new-book')) {
          let newBookCard = bookShelf.querySelector('.new-book');
          bookShelf.removeChild(newBookCard);
          let newBookBtn = document.querySelector('#btn-addBook');
          newBookBtn.classList.remove('no-show');
        } else {
          let book = document.createElement('li');
          book.classList.add('book');
          book.classList.add('new-book');
          book.innerHTML = 
            `<h3>Add new book</h3>
             <form id="new-book-form">
               <label for="title">Book Title: </label>
               <input type="text" id="title">
               <label for="author">Author: </label>
               <input type="text" id="author">
               <label for="pages">Pages: </label>
               <input type="text" id="pages">
               <label for="readornot">Read yet? </label>
               <input type="checkbox" id="readornot">
               <div class="form-buttons">
                 <button type="submit" id="btn-newBook">Add Book</button>
                 <button type="submit" id="btn-cancel">Cancel</button>
               </div>
             </form>`;             
          bookShelf.appendChild(book);

          let confirmNewBookBtn = document.querySelector('#btn-newBook');
          let cancelNewBookBtn = document.querySelector('#btn-cancel');
          confirmNewBookBtn.addEventListener('click', function(e) {
            e.preventDefault();
            let newBook = new Book(document.querySelector("#title").value,
                                   document.querySelector("#author").value,
                                   document.querySelector("#pages").value,
                                   document.querySelector("#readornot").value);
            addBookToLibrary(newBook);
            render();         
            newBookBtn.classList.remove('no-show');  
          });
          cancelNewBookBtn.addEventListener('click', toggleNewBookCard);

          newBookBtn.classList.add('no-show');
        }
      }

      newBookBtn.addEventListener('click', toggleNewBookCard);

      let testBook1 = new Book("The Last Kingdom", "Bernard Cornwell", 415, true);
      let testBook2 = new Book("How to Win Friends and Influence People", "Dale Carnegie", 268, false);
      addBookToLibrary(testBook1);
      addBookToLibrary(testBook2);
      render();

      

      
    </script>
</html>